{% extends "base.html" %}
{% load humanize %}

{% block title %}재고 현황{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="mb-0">
            <i class="fas fa-boxes"></i> 재고 현황
        </h1>
    </div>

    <!-- 재고 경고 -->
    {% if out_of_stock_count > 0 or low_stock_count > 0 %}
    <div class="alert alert-warning mb-4">
        <h5><i class="fas fa-exclamation-triangle"></i> 재고 주의</h5>
        {% if out_of_stock_count > 0 %}
        <p class="mb-1"><strong>품절:</strong> {{ out_of_stock_count }}개 옵션</p>
        {% endif %}
        {% if low_stock_count > 0 %}
        <p class="mb-0"><strong>재고 부족 (10개 이하):</strong> {{ low_stock_count }}개 옵션</p>
        {% endif %}
    </div>
    {% endif %}

    <!-- 재고 목록 -->
    {% if options %}
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
                <tr>
                    <th>제품</th>
                    <th>옵션</th>
                    <th>재고 추적</th>
                    <th class="text-center">현재 재고</th>
                    <th class="text-center">상태</th>
                </tr>
            </thead>
            <tbody>
                {% for option in options %}
                <tr>
                    <td>{{ option.product.name }}</td>
                    <td>{{ option.option_detail }}</td>
                    <td>
                        {% if option.track_inventory %}
                            <span class="badge bg-success">추적</span>
                        {% else %}
                            <span class="badge bg-secondary">비추적</span>
                        {% endif %}
                    </td>
                    <td class="text-center">
                        {% if not option.track_inventory %}
                            <span class="text-muted">-</span>
                        {% elif option.stock_quantity is None %}
                            <span class="text-muted">-</span>
                        {% else %}
                            <strong>{{ option.stock_quantity|intcomma }}</strong>
                        {% endif %}
                    </td>
                    <td class="text-center">
                        {% if option.stock_status == "무제한" %}
                            <span class="badge bg-secondary">무제한</span>
                        {% elif option.stock_status == "품절" %}
                            <span class="badge bg-danger">품절</span>
                        {% elif option.stock_status == "부족" %}
                            <span class="badge bg-warning text-dark">부족</span>
                        {% else %}
                            <span class="badge bg-success">정상</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-info text-center">
        등록된 제품 옵션이 없습니다.
    </div>
    {% endif %}

    <div class="mt-4">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-info-circle"></i> 재고 관리 안내</h5>
            </div>
            <div class="card-body">
                <ul class="mb-0">
                    <li><strong>무제한:</strong> 재고를 추적하지 않거나 무제한으로 설정된 제품 (예: 프린터 잉크)</li>
                    <li><strong>정상:</strong> 재고가 11개 이상인 제품</li>
                    <li><strong>부족:</strong> 재고가 1~10개인 제품 (발주 필요)</li>
                    <li><strong>품절:</strong> 재고가 0개인 제품 (즉시 발주 필요)</li>
                    <li>재고는 주문이 신규에서 다음 단계로 이동할 때 자동으로 차감됩니다.</li>
                    <li>재고 수정은 제품 관리 페이지에서 가능합니다.</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

